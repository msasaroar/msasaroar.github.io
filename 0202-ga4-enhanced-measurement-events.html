<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
    
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l !== 'dataLayer' ? '&l=' + l : '';
                
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-MLGWZBV8');
    </script>
    <!-- End Google Tag Manager -->
        
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>GA4 Enhanced Measurement Events</title>
</head>
<body>

    <h1>GA4 Enhanced Measurement Events Example</h1>

    <!-- Scroll Event: Triggered when the page is scrolled -->
    <div style="height: 1500px; background: lightgray;">
        <h2>Scroll down to trigger the "scroll" event</h2>
        <p>Scroll the page to trigger the "scroll" event.</p>
    </div>

    <!-- Outbound Click Event: External link click -->
    <div>
        <h2>Outbound Click Event</h2>
        <a href="https://www.example.com" target="_blank" id="outbound-link">Click to go to an external site</a>
    </div>

    <!-- Site Search Event: Simulating a search -->
    <div>
        <h2>Site Search Event</h2>
        <input type="text" id="site-search" placeholder="Search this site" oninput="trackSiteSearch()">
    </div>

    <!-- Video Start, Progress, Complete Events -->
    <div>
        <h2>Video Events</h2>
        <video id="video" width="400" controls>
            <source src="https://www.w3schools.com/html/movie.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- File Download Event -->
    <div>
        <h2>File Download Event</h2>
        <a href="https://www.w3.org/WAI/WCAG21/quickref/files/WCAG20.pdf" download id="file-download">Download a PDF file</a>
    </div>

    <script>
        // Scroll Event (Enhanced Measurement)
        window.addEventListener("scroll", function() {
            gtag('event', 'scroll', {
                'scroll_depth': window.scrollY
            });
        });

        // Outbound Click Event (Enhanced Measurement)
        document.getElementById("outbound-link").addEventListener("click", function() {
            gtag('event', 'outbound_click', {
                'outbound_url': this.href
            });
        });

        // Site Search Event (Enhanced Measurement)
        function trackSiteSearch() {
            const searchTerm = document.getElementById("site-search").value;
            if (searchTerm) {
                gtag('event', 'site_search', {
                    'search_term': searchTerm
                });
            }
        }

        // Video Events (Enhanced Measurement)
        const video = document.getElementById('video');
        video.addEventListener('play', function() {
            gtag('event', 'video_start', {
                'video_title': video.getAttribute('title'),
                'video_url': video.currentSrc,
                'video_duration': video.duration
            });
        });

        video.addEventListener('timeupdate', function() {
            const progress = (video.currentTime / video.duration) * 100;
            gtag('event', 'video_progress', {
                'video_title': video.getAttribute('title'),
                'video_current_time': video.currentTime,
                'video_progress': progress
            });
        });

        video.addEventListener('ended', function() {
            gtag('event', 'video_complete', {
                'video_title': video.getAttribute('title'),
                'video_duration': video.duration,
                'video_url': video.currentSrc
            });
        });

        // File Download Event (Enhanced Measurement)
        document.getElementById("file-download").addEventListener("click", function() {
            gtag('event', 'file_download', {
                'file_name': "WCAG20.pdf",
                'file_extension': "pdf",
                'file_url': this.href
            });
        });

        // Page Scroll Event (Enhanced Measurement)
        window.addEventListener('scroll', function() {
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
                gtag('event', 'page_scroll', {
                    'scroll_percentage': 100
                });
            }
        });
    </script>
</body>
</html>
